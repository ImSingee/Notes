title:: 什么是MVCC?

- #CruelFundamental #MySQL [[2022-01-26]] [讨论](https://github.com/Monsooooon/CruelFundamental/tree/main/homework/202201/25)
- 同一条记录在系统中可以存在多个版本，就是数据库的多版本并发控制（MVCC, Multiversion Concurrency control)）
-
- MVCC 只在 [[InnoDB]] 引擎中出现，使用了 [[视图]] 的相关技术，利用 [[undo log]] 实现
-
- MVCC  通过数据行的多个版本管理来实现数据库的并发控制，简单来说就是保存数据的历史版本，可以通过比较版本号来决定数据是否显示，**读取数据的时候不用加锁**可以保证事务的隔离效果
-
- 解决了什么问题：
	- 读写之间阻塞问题，通过MVCC可以让读写相互不阻塞
	- 降低了死锁的概率，因为MVCC采用乐观锁，读数据时，不需要加锁，写数据时只需要锁必要行
	- 解决了一致性读问题
-
- 可以认为MVCC是行级锁的一个变种，但是它在很多情况下避免了加锁操作，因此开销更低。大多数的MVCC都实现了非阻塞的读操作，写操作也只锁定必要的行。
-
- MVCC的实现，是通过保存数据在某个时间点的快照来实现的。也就是说，不管需要执行多长时间，每个事务看到的数据是一致的。根据事务开始的时间不同，每个事物对同一张表，同一时刻看到的数据可能是不一样的。
-
- 只在repeatable read和read comitted两个隔离级别工作。
-
- # 参考资料
	- [如何深入理解 MySQL 的 MVCC 机制？](https://time.geekbang.org/dailylesson/detail/100075767)
-
-