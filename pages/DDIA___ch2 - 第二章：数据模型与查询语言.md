alias:: DDIA/ch2

- [link](https://github.com/Vonng/ddia/blob/master/ch2.md)
-
## 关系模型与文档模型
	- SQL
		- 现在最著名的数据模型
		- 数据被组织成 **关系**（SQL 中称作 **表**），其中每个关系是 **元组**（SQL 中称作 **行**) 的无序集合
	- 多年来，在数据存储和查询方面存在着许多相互竞争的方法
		- 在 20 世纪 70 年代和 80 年代初，**网状模型（network model）**和**层次模型（hierarchical model）**曾是主要的选择
		- 但**关系模型（relational model）**随后占据了主导地位
	- ### NoSQL 的诞生
		- 现在 - 2010 年代，NoSQL 开始了最新一轮尝试，试图推翻关系模型的统治地位
		- NoSQL 被追溯性地重新解释为 **不仅是 SQL（Not Only SQL）**
		- 驱动因素
			- 需要比关系数据库更好的可伸缩性，包括非常大的数据集或非常高的写入吞吐量
			- 相比商业数据库产品，免费和开源软件更受偏爱
			- 关系模型不能很好地支持一些特殊的查询操作
			- 受挫于关系模型的限制性，渴望一种更具多动态性与表现力的数据模型
	- 在可预见的未来，关系数据库似乎可能会继续与各种非关系数据库一起使用 - 这种想法有时也被称为 **混合持久化（polyglot persistence）**
	- ### 对象关系不匹配
		- 目前大多数应用程序开发都使用面向对象的编程语言来开发
		- 对 SQL 数据模型的普遍批评
			- 如果数据存储在关系表中，那么需要一个笨拙的**转换层**，处于应用程序代码中的对象和表，行，列的数据库模型之间
			- 模型之间的不连贯有时被称为 **阻抗不匹配（impedance mismatch）**
			- 像 ActiveRecord 和 Hibernate 这样的 **对象关系映射（ORM object-relational mapping）** 框架可以减少这个转换层所需的样板代码的数量，但是它们不能完全隐藏这两个模型之间的差异
		- JSON 模型*可能*减少了应用程序代码和存储层之间的阻抗不匹配
			- 缺乏一个模式可能也是一个优势
			- JSON 表示比多表模式具有更好的 **局部性（locality）**
	- ### 多对一和多对多的关系
		- 存储 ID 还是文本字符串，这是个 **副本（duplication）** 问题
		- 当使用 ID 时，对人类有意义的信息（比如单词：Philanthropy）只存储在一处，所有引用它的地方使用 ID（ID 只在数据库中有意义）。当直接存储文本时，对人类有意义的信息会复制在每处使用记录中。
		- 使用 ID 的好处是，ID 对人类没有任何意义，因而永远不需要改变：ID 可以保持不变，即使它标识的信息发生变化。任何对人类有意义的东西都可能需要在将来某个时候改变 —— 如果这些信息被复制，所有的冗余副本都需要更新。这会导致写入开销，也存在不一致的风险（一些副本被更新了，还有些副本没有被更新）。去除此类重复是数据库 **规范化（normalization）** 的关键思想。
		- 在关系数据库中，通过 ID 来引用其他表中的行是正常的，因为连接很容易。在文档数据库中，一对多树结构没有必要用连接，对连接的支持通常很弱
		- **如果数据库本身不支持连接，则必须在应用程序代码中通过对数据库进行多个查询来模拟连接**
	- ### 文档数据库是否在重蹈覆辙？
		- 在多对多的关系和连接已常规用在关系数据库时，文档数据库和 NoSQL 重启了辩论：如何以最佳方式在数据库中表示**多对多关系**
		- **网状模型**
			- 网状模型由一个称为数据系统语言会议（CODASYL）的委员会进行了标准化，并被数个不同的数据库厂商实现；它也被称为 CODASYL 模型
			- CODASYL 模型是层次模型的推广。在层次模型的树结构中，每条记录只有一个父节点；在网络模式中，每条记录可能有多个父节点。
			- 网状模型中记录之间的链接不是外键，而更像编程语言中的指针（同时仍然存储在磁盘上）。访问记录的唯一方法是跟随从根记录起沿这些链路所形成的路径。这被称为 **访问路径（access path）**。
			- 最简单的情况下，访问路径类似遍历链表：从列表头开始，每次查看一条记录，直到找到所需的记录。但在多对多关系的情况中，数条不同的路径可以到达相同的记录，网状模型的程序员**必须跟踪这些不同的访问路径**。
		- **关系模型**
			- 你可以在任何表中插入一个新的行，而不必担心与其他表的外键关系
			- 查询优化器自动决定查询的哪些部分以哪个顺序执行，以及使用哪些索引。这些选择实际上是 “访问路径”，但最大的区别在于它们是由查询优化器自动生成的，而不是由程序员生成
	- ### 关系型数据库与文档数据库在今日的对比
		- 对比点
			- 数据模型（本章）
			- 容错属性（第五章）
			- 处理并发性（第七章）
		- 优势
			- 文档数据模型：架构灵活性，因局部性而拥有更好的性能，以及对于某些应用程序而言更接近于应用程序使用的数据结构
			- 关系模型：为连接提供更好的支持以及支持多对一和多对多的关系
		- **哪种数据模型更有助于简化应用代码？**
			- 如果应用程序中的数据具有类似文档的结构（即，一对多关系树，通常一次性加载整个树），那么使用文档模型可能是一个好主意
			- 但如果你的应用程序确实会用到多对多关系，那么文档模型就没有那么诱人了。尽管可以通过反规范化来消除对连接的需求，但这需要应用程序代码来做额外的工作以确保数据一致性
		- **文档模型中的模式灵活性**
			-
		- #TODO https://github.com/Vonng/ddia/blob/master/ch2.md#%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E6%96%87%E6%A1%A3%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9C%A8%E4%BB%8A%E6%97%A5%E7%9A%84%E5%AF%B9%E6%AF%94
		-