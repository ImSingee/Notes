---
title: sys.PtrSize
---

- #Golang #go1.16
-
- Go ä¸­ä½¿ç”¨ [sys.PtrSize](https://github.com/golang/go/blob/release-branch.go1.16/src/runtime/internal/sys/stubs.go#L9:7) ä»£è¡¨ [[æŒ‡é’ˆé•¿åº¦]]ï¼ˆå•ä½ä¸ºå­—èŠ‚ï¼‰
-
- ```javascript
  // unsafe.Sizeof(uintptr(0)) but an ideal const
  const PtrSize = 4 << (^uintptr(0) >> 63)
  ```
-
- è¿™ä¸ªæ³¨é‡Šå¾ˆå¥½ç©ï¼Œåˆ©ç”¨çš„æ˜¯ [[uintptr]] ç±»å‹ï¼Œ`uintptr(0)` æ˜¯ä¸€ä¸ªä½é•¿åº¦ç­‰åŒäºç³»ç»ŸæŒ‡é’ˆé•¿åº¦ï¼ˆ32 ä½ç³»ç»Ÿä¸º 32bit = 4Byteï¼Œ64 ä½ç³»ç»Ÿä¸º 64bit=8Byteï¼‰çš„ 0 å€¼ï¼Œå› æ­¤æƒ³è¦çŸ¥é“ä¸€ä¸ªæŒ‡é’ˆæ˜¯å¤šå°‘ Byte è°ƒç”¨ [[unsafe.Sizeof]] å°±å¯ä»¥
-
- ç„¶è€Œ Go ä¸­æ²¡æœ‰å¸¸é‡å‡½æ•°ï¼Œå› æ­¤æ— æ³•è°ƒç”¨ `unsafe.Sizeof` å‡½æ•°å¹¶å°†ç»“æœä½œä¸ºå¸¸æ•°ï¼Œå› æ­¤ Go ç”¨äº†ä¸€ä¸ª tricky çš„åšæ³•ã€‚ã€‚ã€‚
	- `uintptr(0)` ä¼šäº§ç”Ÿ 32/64 ä¸ª 0
	- `^uintptr(0)` ä¼šäº§ç”Ÿ 32/64 ä¸ª 1
	- `(^uintptr(0) >> 63)` å¯¹äº 32 ä½æœºå™¨ä¸º 0ï¼Œè€Œå¯¹äº 64 ä½æœºå™¨ä¸º 1
	- `4 << (^uintptr(0) >> 63)` å¯¹äº 32 ä½æœºå™¨ä¸º `4 << 0 = 4`ï¼Œè€Œå¯¹äº 64 ä½æœºå™¨ä¸º `4 << 1=8`
-
- å¾ˆæ˜æ˜¾ï¼Œå¯¹äº 32/64 ä½æ¶æ„æ˜¯è¶³å¤Ÿçš„ğŸŒšå½“ç„¶æœªæ¥å‡ºäº† 128 ä½æœºå™¨å°±ä¸è¡Œäº†
-